<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <data>
    <record id="helpdesk_memo_view_kanban_dashboard" model="ir.ui.view">
      <field name="name">helpdesk.memo.kanban.dashboard</field>
      <field name="model">memo.model</field>
      <field name="priority">210</field>
      <field name="arch" type="xml">
        <kanban class="o_kanban_dashboard o_helpdesk_kanban" group_create="0" create="0">

        <templates>
            <t t-name="dashboard">
              <div class="o_helpdesk_dashboard_header o_helpdesk_banner align-items-start flex-column flex-lg-row flex-shrink-0 d-flex py-4 border-bottom bg-view">
                <div class="col text-center">
                  <h3>Total Tickets</h3>
                  <span><field name="task_count"/></span>
                </div>
                <div class="col text-center">
                  <h3>Resolved Tickets</h3>
                  <span><field name="resolved_count"/></span>
                </div>
                <div class="col text-center">
                  <h3>Pending Tickets</h3>
                  <span><field name="pending_count"/></span>
                </div>
              </div>
            </t>
          </templates>
          
          <div t-call="dashboard"/>

          <field name="name"/>
          <field name="task_count"/>
          <field name="resolved_count"/>
          <field name="pending_count"/>
          <templates>
            <t t-name="kanban-box">
              <div class="oe_kanban_global_click">
                <!-- Card Header -->
                <div class="o_kanban_card_header">
                  <div class="o_kanban_card_header_title">
                    <div class="o_primary">
                      <field name="name"/>
                    </div>
                  </div>
                  <div class="o_kanban_manage_button_section">
                    <a class="o_kanban_manage_toggle_button o_dropdown_kanban" href="#">
                      <i class="fa fa-ellipsis-v" role="img" aria-label="Manage" title="Manage"/>
                    </a>
                  </div>
                </div>
                <!-- Card Content with Statistics -->
                <div class="o_kanban_card_content">
                  <div class="mb4">
                    <span>Total Tasks: </span>
                    <span class="ms-2"><field name="task_count"/></span>
                  </div>
                  <div class="mb4">
                    <span>Resolved: </span>
                    <span class="ms-2"><field name="resolved_count"/></span>
                  </div>
                  <div class="mb4">
                    <span>Pending: </span>
                    <span class="ms-2"><field name="pending_count"/></span>
                  </div>
                </div>
                <!-- Footer with clickable areas for details -->
                <div class="row pt-4">
                  <div class="col border-end">
                    <a name="action_view_resolved" type="object" class="d-flex flex-column align-items-center">
                      <span class="fw-bold"><field name="resolved_count"/></span>
                      <span class="text-muted">Resolved</span>
                    </a>
                  </div>
                  <div class="col">
                    <a name="action_view_pending" type="object" class="d-flex flex-column align-items-center">
                      <span class="fw-bold"><field name="pending_count"/></span>
                      <span class="text-muted">Pending</span>
                    </a>
                  </div>
                  <div class="col border-start">
                    <a name="action_view_all_tasks" type="object" class="d-flex flex-column align-items-center">
                      <span class="fw-bold"><field name="task_count"/></span>
                      <span class="text-muted">Total</span>
                    </a>
                  </div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    <!-- Action for the Kanban view (ensure the domain limits it to helpdesk memos) -->
    <record id="helpdesk_memo_dashboard_action" model="ir.actions.act_window">
      <field name="name">Helpdesk Memos Overview</field>
      <field name="res_model">memo.model</field>
      <field name="view_mode">kanban,tree,form</field>
      <field name="view_id" ref="helpdesk_process.helpdesk_memo_view_kanban_dashboard"/>
      <field name="domain">[('memo_type_key','=','helpdesk')]</field>
      <field name="context">{}</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          No helpdesk memos found.
        </p>
        <p>
          Create a helpdesk memo to start tracking resolutions and statistics.
        </p>
      </field>
    </record>

    <!-- Menu Item to Access the Kanban Dashboard -->
    <menuitem id="helpdesk_dashboard_menu" name="Helpdesk Dashboard" parent="helpdesk_process.internal_memo_helpdesk_main"
              action="helpdesk_memo_dashboard_action" sequence="8"/>
  </data>
</odoo>